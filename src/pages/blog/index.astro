---
import BaseHead from '../../components/BaseHead.astro';
import Header from '../../components/Header.astro';
import Footer from '../../components/Footer.astro';
import { SITE_TITLE, SITE_DESCRIPTION } from '../../consts';
import { getCollection } from 'astro:content';
import FormattedDate from '../../components/FormattedDate.astro';

const posts = (await getCollection('blog')).sort(
    (a, b) => b.data.pubDate.valueOf() - a.data.pubDate.valueOf(),
);
---

<!doctype html>
<html lang="fr">
    <head>
        <BaseHead title={SITE_TITLE} description={SITE_DESCRIPTION} />
    </head>
    <body class="bg-gray-50 text-gray-800 font-sans antialiased">
        <Header />
        <main class="w-full max-w-6xl mx-auto my-6 sm:my-8 px-1 sm:px-4 lg:px-8">
            <section class="mb-6 sm:mb-10 mt-16 sm:mt-20 md:mt-24">
                <div class="text-center mb-5 sm:mb-8">
                    <h1 class="text-xl sm:text-3xl md:text-4xl font-extrabold text-blue-700 mb-1 sm:mb-2">Tous les chapitres du cours Laravel 10</h1>
                    <p class="text-gray-600 max-w-2xl mx-auto text-xs sm:text-base">Retrouvez ici tous les chapitres, astuces et bonnes pratiques pour maîtriser Laravel 10 et TailwindCSS avec UniTechs.</p>
                </div>
                <ul class="grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-4 sm:gap-8 list-none p-0 m-0">
                    {posts.map((post, idx) => (
                        <li
                            class={[
                                "flex flex-col bg-white rounded-2xl shadow-lg hover:shadow-2xl transition-shadow duration-200 overflow-hidden border border-gray-100",
                                idx === 0 ? "md:col-span-2 xl:col-span-3 row-span-2" : ""
                            ].join(" ")}
                        >
                            <a href={`/blog/${post.slug}/`} class="w-full h-full flex flex-col group focus:outline-none focus:ring-2 focus:ring-blue-400">
                                <div class={[
                                    "relative w-full overflow-hidden",
                                    idx === 0
                                        ? "aspect-[16/6] sm:aspect-[16/7] md:aspect-[16/5] xl:aspect-[16/4] max-h-[340px]"
                                        : "aspect-[16/9] sm:aspect-[16/8] md:aspect-[16/7] xl:aspect-[16/6] max-h-[220px]"
                                ].join(" ")}>
                                    <img
                                        width={720}
                                        height={360}
                                        src={post.data.heroImage}
                                        alt={post.data.title}
                                        class="object-cover w-full h-full transition-transform duration-300 group-hover:scale-105 group-hover:brightness-95"
                                        loading="lazy"
                                    />
                                    <div class="absolute top-1 left-1 sm:top-2 sm:left-2 bg-white/80 rounded-full px-2 py-0.5 sm:px-3 sm:py-1 text-[10px] sm:text-xs font-semibold text-blue-700 shadow">
                                        <FormattedDate date={post.data.pubDate} />
                                    </div>
                                    {idx === 0 && (
                                        <span class="absolute bottom-1 right-1 sm:bottom-2 sm:right-2 bg-blue-600 text-white text-[10px] sm:text-xs px-2 py-0.5 sm:px-3 sm:py-1 rounded-full shadow font-semibold uppercase tracking-wide">À la une</span>
                                    )}
                                </div>
                                <div class="flex-1 flex flex-col justify-between p-3 sm:p-5">
                                    <h4 class={[
                                        "font-bold mb-1 sm:mb-2 text-blue-700 leading-tight transition-colors duration-200 group-hover:text-blue-900",
                                        idx === 0 ? "text-base sm:text-2xl md:text-3xl" : "text-sm sm:text-lg md:text-xl"
                                    ].join(" ")}>
                                        {post.data.title}
                                    </h4>
                                    <p class="text-gray-600 text-xs sm:text-sm mb-2 sm:mb-3 line-clamp-3">{post.data.description}</p>
                                    <div class="flex items-center gap-1 sm:gap-2 mt-auto">
                                        <span class="inline-flex items-center px-2 py-0.5 sm:px-3 sm:py-1 bg-blue-50 text-blue-700 rounded-full text-[10px] sm:text-xs font-semibold">
                                            <svg class="w-3 h-3 sm:w-4 sm:h-4 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3" />
                                                <circle cx="12" cy="12" r="10" stroke="currentColor" stroke-width="2" fill="none"/>
                                            </svg>
                                            Lecture rapide
                                        </span>
                                        <span class="ml-auto text-blue-600 font-semibold group-hover:underline flex items-center gap-1 text-xs sm:text-sm">
                                            Lire le chapitre
                                            <svg class="w-3 h-3 sm:w-4 sm:h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 8l4 4m0 0l-4 4m4-4H3"/>
                                            </svg>
                                        </span>
                                    </div>
                                </div>
                            </a>
                        </li>
                    ))}
                </ul>
            </section>
        </main>
        <Footer />
    </body>
</html>